G## -*- coding: utf-8 -*-
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="/css/style.css" />
<link rel="stylesheet" type="text/css" href="/css/pygments.css" />
<link rel="stylesheet" type="text/css" href="/css/archive.css" />
<link rel="shortcut icon" href="/favico.ico" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="/
feed
.xml" />
<title>Revolution blahg 
    | Copr design - being all things to all people
</title>
</head>
<body>
<div id="container">
<div id="header">
<h1><a href="/" class="title">Revolution blahg</a></h1><a href="/">home</a>
<a href="/archive">archive</a>
<a href="/about">about</a>

</div>
<div id="sidebar">
<div id="recent">
<h4>Recent</h4>
<ul>
<li><a href="http://mapleoin.eu/perma/sql-and-relational-theory-master">SQL and Relation Theory Master Class</a></li>
<li><a href="http://mapleoin.eu/perma/copr-final-report">Copr final report</a></li>
<li><a href="http://mapleoin.eu/perma/moving-on-to-the-buildsystem">FSC: moving to the buildsystem</a></li>
<li><a href="http://mapleoin.eu/perma/copr-client-part-2">the Copr client part II</a></li>
<li><a href="http://mapleoin.eu/perma/copr-client">the Copr client</a></li>
</ul>
</div><!--recent-->
<br />
<div id="tags">
<h4>Tags</h4>
<ul>
<li><a href="/tag/gsoc.html">gsoc</a></li>
<li><a href="/tag/packaging.html">packaging</a></li>
<li><a href="/tag/fedora.html">fedora</a></li>
<li><a href="/tag/python.html">python</a></li>
<li><a href="/tag/unix.html">unix</a></li>
<li><a href="/tag/databases.html">databases</a></li>
<li><a href="/tag/programming.html">programming</a></li>
<li><a href="/tag/floss.html">floss</a></li>
<li><a href="/tag/django.html">django</a></li>
<li><a href="/tag/copr.html">copr</a></li>
<li><a href="/tag/fedora-summer-coding.html">fedora-summer-coding</a></li>
<li><a href="/tag/books.html">books</a></li>
<li><a href="/tag/emacs.html">emacs</a></li>
<li><a href="/tag/freebsd.html">freebsd</a></li>
<li><a href="/tag/linux.html">linux</a></li>
<li><a href="/tag/creativecommons.html">creativecommons</a></li>
<li><a href="/tag/music.html">music</a></li>
<li><a href="/tag/hacking.html">hacking</a></li>
<li><a href="/tag/foss.html">foss</a></li>
<li><a href="/tag/fedora-ro.html">fedora-ro</a></li>
<li><a href="/tag/events.html">events</a></li>
</ul>
</div><!--tags-->
</div><!--sidebar-->
<div id="content">
    <div class="post">
        <h2><a href="http://mapleoin.eu/perma/copr-design-being-all-things">Copr design - being all things to all people</a></h2>
        <h3>Monday, August  9, 2010</h3>
        <div class="entry">
             <p>Lots of things happened this third Fedora Summer Coding week. Most people are already wrapping up, but I feel like I&#8217;m still at the beginning.</p>
<p>The biggest accomplishment of this week has got to be the fact that we (I and my mentor, Toshio) settled on a stable design for representing Coprs, Repos and their relationships. It was harder than it might seem, since we&#8217;ve got all these different entities in Fedora: we&#8217;ve got repos that you could look at as being either a directory with a release and an architecture or a repofile that is the same across releases and arches. When talking about releases we&#8217;ve got Fedora releases (e.g. Fedora 13, Fedora 14) and then we&#8217;ve got the packages for other distros with their own releases: <span class="caps">EPEL</span> and <span class="caps">OLPC</span>.</p>
<p>Now, on top of all of this we&#8217;ve got Coprs and (at least) two groups of users for the API: the end-users of the Coprs &#8211; the people that install the repos and the packages and the developers of the packages in the Coprs. The end users shouldn&#8217;t have to deal with the intricacies of the Copr/Repos/Releases model; ideally they&#8217;d just have one big button per the distribution they&#8217;re using, so they can install the repo once and have it work even after they&#8217;ve upgraded their distro three times or reinstalled five times (which is sort of how a repofile works). The package developers on the other hand could get hurt by the differences between different distro releases and their different packages &#8211; when depending on different package versions for example.</p>
<p>So finally we get to Coprs which should basically be a collection of packages that are available for one or more distros with each one having one or more releases. The package maintainer gets to create a Copr and choose a number of releases which they want to support with that Copr. One Copr can depend on as many other Coprs as needed. When the maintainer creates a Copr, the Copr App will automatically create repos for all of the specified releases and for each of the architectures that are supported by the buildsystem.</p>
<p>Everything I said until now is already implemented at the level of the TurboGears App which will provide the <span class="caps">API</span> for the web interface and any number of <span class="caps">JSON</span> clients. The schema is built and the database insteraction works fine, but repos don&#8217;t actually get created, because that&#8217;s not part of my proposal and will be handled at a different level. Oh and it&#8217;s all unit tested!</p>
<p>This week wasn&#8217;t just designing and building though, I spent a lot of time digging through TurboGears2 and its sub-packages&#8217; documentation for things that should make the code simpler: raising <span class="caps">JSON</span> errors from nested functions, sending list arguments to <span class="caps">JSON</span> functions via WebTest post requests and even returning a flat list from a SQLAlchemy query on a single table column. All of these things seem to me like they should already be implemented and easy to use which makes me waste time searching for them. In fact they either are bugs or require coding them myself (at least from what I understand so far). I&#8217;ll have to investigate further, especially now since the weekend is over and I hope there&#8217;ll be more people answering questions on <span class="caps">IRC</span> and on issue trackers.</p>
<p>This next week I&#8217;ll mostly start worrying about what happens when a package maintainer submits a package to be built and that package has the right dependencies available in some releases, but not others, even though the Copr should support all of them. Will she have to submit different <span class="caps">SRPMS</span> for each release or should the Copr have the same version of the package in all of its releases? This will be a matter of settling upon a contract that the Copr provides its users and how uniform the Copr&#8217;s content has to be.</p>
<p>Fedora Summer Coding! Yay!</p>
        </div>
        <div class="post_tags">Tags:
                <a href="/tag/copr.html">copr</a>
                <a href="/tag/fedora.html">fedora</a>
                <a href="/tag/foss.html">foss</a>
                <a href="/tag/fedora-summer-coding.html">fedora-summer-coding</a>
        </div>
        <br />
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          /** * var disqus_identifier; [Optional but recommended: Define
          a unique identifier (e.g. post id or slug) for this thread] */
          (function() { var dsq = document.createElement('script');
          dsq.type = 'text/javascript'; dsq.async = true; dsq.src =
          'http://revolutionblahg.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] ||
          document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view
        the <a href="http://disqus.com/?ref_noscript=revolutionblahg">comments
        powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">blog comments
        powered by <span class="logo-disqus">Disqus</span></a>
    </div>
</div>
<div style="clear: right;"></div>
</div><!-- container -->
<div id="smallprint"><a rel="license" href="http://creativecommons.org/licenses/by/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>.</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-5576939-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
